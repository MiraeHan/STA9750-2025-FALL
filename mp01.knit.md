---
title: "Exploring the Most Popular Programming on Netflix"
subtitle: "Exploring Netflix Top-10 Data"
author: Mirae Han
date: "10월 06, 2025"
format: 
  html: 
    code-tools: true
    code-fold: true
    toc: true
    toc-location: right
    number-sections: true
    toc-depth: 3
execute:
  eval: true
csl: apa.csl
---

# Data Analyst's Summary

## Key Facts

* 1. Netflix currently operates in **94 different countries** around the world, offering a wide variety of shows and movies tailored to local audiences.


::: {.cell}

```{.r .cell-code}
#Load Packages

if(!require("tidyverse")) install.packages("tidyverse")
library(readr)
library(dplyr)
library(stringr)
library(DT)
library(knitr)
library(ggplot2)

#Acquire Data

if(!dir.exists(file.path("data", "mp01"))){
    dir.create(file.path("data", "mp01"), showWarnings=FALSE, recursive=TRUE)
}

GLOBAL_TOP_10_FILENAME <- file.path("data", "mp01", "global_top10_alltime.csv")

if(!file.exists(GLOBAL_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-global.tsv", 
                  destfile=GLOBAL_TOP_10_FILENAME)
}

COUNTRY_TOP_10_FILENAME <- file.path("data", "mp01", "country_top10_alltime.csv")

if(!file.exists(COUNTRY_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-countries.tsv", 
                  destfile=COUNTRY_TOP_10_FILENAME)
}

#Read files

GLOBAL_TOP_10 <- read_tsv(
  GLOBAL_TOP_10_FILENAME, na = "N/A", show_col_types = FALSE)

COUNTRY_TOP_10 <- read_tsv(
  COUNTRY_TOP_10_FILENAME,na = "N/A", show_col_types = FALSE)


#Formatted


format_titles <- function(df){
    colnames(df) <- str_replace_all(colnames(df), "_", " ") |> str_to_title()
    df
}

#Exploratory Questions

#Q1
countries_n <- COUNTRY_TOP_10 |>
  summarize(n_countries = n_distinct(country_name))
```
:::






* 2. The non-English-language film that has spent the most cumulative weeks in the global Top 10 is Squid Game: Season 1, which remained on the list for **32 weeks** in total.


::: {.cell}

```{.r .cell-code}
#Load Packages

if(!require("tidyverse")) install.packages("tidyverse")
library(readr)
library(dplyr)
library(stringr)
library(DT)

#Acquire Data

if(!dir.exists(file.path("data", "mp01"))){
    dir.create(file.path("data", "mp01"), showWarnings=FALSE, recursive=TRUE)
}

GLOBAL_TOP_10_FILENAME <- file.path("data", "mp01", "global_top10_alltime.csv")

if(!file.exists(GLOBAL_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-global.tsv", 
                  destfile=GLOBAL_TOP_10_FILENAME)
}

#Read files

GLOBAL_TOP_10 <- read_tsv(
  GLOBAL_TOP_10_FILENAME, na = "N/A", show_col_types = FALSE)


#Formatted


format_titles <- function(df){
    colnames(df) <- str_replace_all(colnames(df), "_", " ") |> str_to_title()
    df
}

#Exploratory Questions

#Q2

GLOBAL_TOP_10 |> 
  filter(str_detect(category, "Non-English")) |>
  slice_max(cumulative_weeks_in_top_10, n = 1, with_ties = FALSE) |>
  mutate(`runtime_(minutes)` = round(60 * runtime)) |>
  select(-season_title, -runtime) |>
  format_titles() |>
  datatable(options = list(searching = FALSE, info = FALSE)) |>
  formatRound(c('Weekly Hours Viewed', 'Weekly Views'))
```

::: {.cell-output-display}

```{=html}
<div class="datatables html-widget html-fill-item" id="htmlwidget-57f10941b1ea8e870585" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-57f10941b1ea8e870585">{"x":{"filter":"none","vertical":false,"data":[["1"],["2025-07-13"],["TV (Non-English)"],[7],["Squid Game"],[19100000],[2300000],[32],[499]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Week<\/th>\n      <th>Category<\/th>\n      <th>Weekly Rank<\/th>\n      <th>Show Title<\/th>\n      <th>Weekly Hours Viewed<\/th>\n      <th>Weekly Views<\/th>\n      <th>Cumulative Weeks In Top 10<\/th>\n      <th>Runtime (Minutes)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"searching":false,"info":false,"columnDefs":[{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[3,5,6,7,8]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Week","targets":1},{"name":"Category","targets":2},{"name":"Weekly Rank","targets":3},{"name":"Show Title","targets":4},{"name":"Weekly Hours Viewed","targets":5},{"name":"Weekly Views","targets":6},{"name":"Cumulative Weeks In Top 10","targets":7},{"name":"Runtime (Minutes)","targets":8}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render"],"jsHooks":[]}</script>
```

:::
:::






* 3. The longest program to have appeared in the Netflix global Top 10 is Until You Burn: Season 1, with an estimated total runtime of approximately 2,855 minutes.


::: {.cell}

```{.r .cell-code}
#Load Packages

if(!require("tidyverse")) install.packages("tidyverse")
library(readr)
library(dplyr)
library(stringr)
library(DT)

#Acquire Data

if(!dir.exists(file.path("data", "mp01"))){
    dir.create(file.path("data", "mp01"), showWarnings=FALSE, recursive=TRUE)
}

GLOBAL_TOP_10_FILENAME <- file.path("data", "mp01", "global_top10_alltime.csv")

if(!file.exists(GLOBAL_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-global.tsv", 
                  destfile=GLOBAL_TOP_10_FILENAME)
}

#Read files

GLOBAL_TOP_10 <- read_tsv(
  GLOBAL_TOP_10_FILENAME, na = "N/A", show_col_types = FALSE)


#Formatted


format_titles <- function(df){
    colnames(df) <- str_replace_all(colnames(df), "_", " ") |> str_to_title()
    df
}

#Exploratory Questions

#Q3
GLOBAL_TOP_10 |> 
  slice_max(runtime, n = 1, with_ties = FALSE) |>
  mutate(`runtime_(minutes)` = round(60 * runtime)) |>
  select(-season_title, -runtime) |>
  format_titles() |>
  datatable(options = list(searching = FALSE, info = FALSE)) |>
  formatRound(c('Weekly Hours Viewed', 'Weekly Views'))
```

::: {.cell-output-display}

```{=html}
<div class="datatables html-widget html-fill-item" id="htmlwidget-53cfe792b4b1670b68c7" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-53cfe792b4b1670b68c7">{"x":{"filter":"none","vertical":false,"data":[["1"],["2025-04-06"],["TV (Non-English)"],[10],["Until You Burn"],[44400000],[900000],[1],[2855]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Week<\/th>\n      <th>Category<\/th>\n      <th>Weekly Rank<\/th>\n      <th>Show Title<\/th>\n      <th>Weekly Hours Viewed<\/th>\n      <th>Weekly Views<\/th>\n      <th>Cumulative Weeks In Top 10<\/th>\n      <th>Runtime (Minutes)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"searching":false,"info":false,"columnDefs":[{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[3,5,6,7,8]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Week","targets":1},{"name":"Category","targets":2},{"name":"Weekly Rank","targets":3},{"name":"Show Title","targets":4},{"name":"Weekly Hours Viewed","targets":5},{"name":"Weekly Views","targets":6},{"name":"Cumulative Weeks In Top 10","targets":7},{"name":"Runtime (Minutes)","targets":8}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render"],"jsHooks":[]}</script>
```

:::
:::






* 4. For each of the four categories, the program with the most total hours of global viewership is as follows: 


::: {.cell}

```{.r .cell-code}
#Load Packages

if(!require("tidyverse")) install.packages("tidyverse")
library(readr)
library(dplyr)
library(stringr)
library(DT)

#Acquire Data

if(!dir.exists(file.path("data", "mp01"))){
    dir.create(file.path("data", "mp01"), showWarnings=FALSE, recursive=TRUE)
}

GLOBAL_TOP_10_FILENAME <- file.path("data", "mp01", "global_top10_alltime.csv")

if(!file.exists(GLOBAL_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-global.tsv", 
                  destfile=GLOBAL_TOP_10_FILENAME)
}

#Read files

GLOBAL_TOP_10 <- read_tsv(
  GLOBAL_TOP_10_FILENAME, na = "N/A", show_col_types = FALSE)


#Formatted


format_titles <- function(df){
    colnames(df) <- str_replace_all(colnames(df), "_", " ") |> str_to_title()
    df
}

#Exploratory Questions

#Q4
top_by_category <- GLOBAL_TOP_10 |>
  group_by(category, show_title) |>
  summarize(total_hours = sum(weekly_hours_viewed, na.rm = TRUE), .groups = "drop_last") |>
  slice_max(total_hours, n = 1, with_ties = FALSE) |>
  ungroup() |>
  rename(
    Category = category,
    `Show Title` = show_title,
    `Total Hours` = total_hours
  )

datatable(
  top_by_category,
  options = list(
    dom = 't',
    paging = FALSE,
    ordering = FALSE,
    info = FALSE
  ),
  rownames = FALSE
) |>
  formatRound("Total Hours", 0)
```

::: {.cell-output-display}

```{=html}
<div class="datatables html-widget html-fill-item" id="htmlwidget-a3296c6d2e50539b8774" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a3296c6d2e50539b8774">{"x":{"filter":"none","vertical":false,"data":[["Films (English)","Films (Non-English)","TV (English)","TV (Non-English)"],["KPop Demon Hunters","Society of the Snow","Stranger Things","Squid Game"],[591300000,235900000,2967980000,5048300000]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Category<\/th>\n      <th>Show Title<\/th>\n      <th>Total Hours<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","paging":false,"ordering":false,"info":false,"columnDefs":[{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":2},{"name":"Category","targets":0},{"name":"Show Title","targets":1},{"name":"Total Hours","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render"],"jsHooks":[]}</script>
```

:::
:::






* 5. **“Money Heist”** had the longest run in a country’s Top 10, spending **127 weeks** in Pakistan’s Top 10 chart. 


::: {.cell}

```{.r .cell-code}
#Load Packages

if(!require("tidyverse")) install.packages("tidyverse")
library(readr)
library(dplyr)
library(stringr)
library(DT)

#Acquire Data

if(!dir.exists(file.path("data", "mp01"))){
    dir.create(file.path("data", "mp01"), showWarnings=FALSE, recursive=TRUE)
}

COUNTRY_TOP_10_FILENAME <- file.path("data", "mp01", "country_top10_alltime.csv")

if(!file.exists(COUNTRY_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-countries.tsv", 
                  destfile=COUNTRY_TOP_10_FILENAME)
}

#Read files



COUNTRY_TOP_10 <- read_tsv(
  COUNTRY_TOP_10_FILENAME,na = "N/A", show_col_types = FALSE)


#Formatted


format_titles <- function(df){
    colnames(df) <- str_replace_all(colnames(df), "_", " ") |> str_to_title()
    df
}

#Exploratory Questions

#Q5
top_tv_cum <- COUNTRY_TOP_10 |>
  filter(str_detect(category, "^TV")) |>           
  slice_max(cumulative_weeks_in_top_10, n = 1, with_ties = FALSE) |>  
  select(country_name, show_title, cumulative_weeks_in_top_10) |>     
  format_titles()                                 

DT::datatable(
  top_tv_cum,
  options = list(
    dom = 't',
    paging = FALSE,
    ordering = FALSE,
    info = FALSE
  ),
  rownames = FALSE
) 
```

::: {.cell-output-display}

```{=html}
<div class="datatables html-widget html-fill-item" id="htmlwidget-41ce34457acd80092442" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-41ce34457acd80092442">{"x":{"filter":"none","vertical":false,"data":[["Pakistan"],["Money Heist"],[127]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Country Name<\/th>\n      <th>Show Title<\/th>\n      <th>Cumulative Weeks In Top 10<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","paging":false,"ordering":false,"info":false,"columnDefs":[{"className":"dt-right","targets":2},{"name":"Country Name","targets":0},{"name":"Show Title","targets":1},{"name":"Cumulative Weeks In Top 10","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
```

:::
:::






* 6.**Russia** had only 35 weeks of Top 10 data, when **reporting ended on February 27, 2022**.


::: {.cell}

```{.r .cell-code}
country_week_counts <- COUNTRY_TOP_10 |>
  mutate(week = as.Date(week)) |>
  summarize(
    weeks_available = dplyr::n_distinct(week),
    last_week_with_data = max(week, na.rm = TRUE),
    .by = country_name
  ) |>
  slice_min(weeks_available, n = 1, with_ties = FALSE) |>   # 가장 작은 1개만 선택
  rename(
    `Country Name` = country_name,
    `Weeks Available` = weeks_available,
    `Last Week With Data` = last_week_with_data
  )

DT::datatable(
  country_week_counts,
  options = list(dom = 't', paging = FALSE, ordering = FALSE, info = FALSE),
  rownames = FALSE
)
```

::: {.cell-output-display}

```{=html}
<div class="datatables html-widget html-fill-item" id="htmlwidget-3dc589f341d278a21ec5" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3dc589f341d278a21ec5">{"x":{"filter":"none","vertical":false,"data":[["Russia"],[35],["2022-02-27"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Country Name<\/th>\n      <th>Weeks Available<\/th>\n      <th>Last Week With Data<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","paging":false,"ordering":false,"info":false,"columnDefs":[{"className":"dt-right","targets":1},{"name":"Country Name","targets":0},{"name":"Weeks Available","targets":1},{"name":"Last Week With Data","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
```

:::
:::






* 7.The total global **viewership** of Squid Game across all three seasons is approximately **5.05 billion hours**.


::: {.cell}

```{.r .cell-code}
sg_seasons_core <- GLOBAL_TOP_10 |>
  filter(str_detect(category, "^TV"),
         show_title == "Squid Game",
         !is.na(season_title)) |>
  group_by(season_title) |>
  summarize(`Total Hours` = sum(weekly_hours_viewed, na.rm = TRUE), .groups = "drop")

sg_seasons_core <- sg_seasons_core |>
  mutate(.season_num = suppressWarnings(as.integer(str_extract(season_title, "\\d+")))) |>
  arrange(.season_num, season_title) |>
  select(-.season_num)

sg_total_core <- sg_seasons_core |>
  summarize(season_title = "Grand Total",
            `Total Hours` = sum(`Total Hours`, na.rm = TRUE))


sg_pivot_core <- bind_rows(sg_seasons_core, sg_total_core) |>
  rename(Seasons = season_title)

DT::datatable(
  sg_pivot_core,
  options = list(dom='t', paging=FALSE, ordering=FALSE, info=FALSE),
  rownames = FALSE
) |>
  formatRound("Total Hours", 0)
```

::: {.cell-output-display}

```{=html}
<div class="datatables html-widget html-fill-item" id="htmlwidget-ee2e59f1456c1bcb47ea" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ee2e59f1456c1bcb47ea">{"x":{"filter":"none","vertical":false,"data":[["Squid Game: Season 1","Squid Game: Season 2","Squid Game: Season 3","Grand Total"],[2729400000,1445500000,873400000,5048300000]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Seasons<\/th>\n      <th>Total Hours<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","paging":false,"ordering":false,"info":false,"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":1},{"name":"Seasons","targets":0},{"name":"Total Hours","targets":1}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render"],"jsHooks":[]}</script>
```

:::
:::






* 8.In 2021, Red Notice was viewed approximately **201 million times** worldwide, based on its total of 396.7 million viewing hours and a runtime of 1 hour and 58 minutes.


::: {.cell}

```{.r .cell-code}
runtime_hours <- 1 + 58/60


red_notice_views_2021 <- GLOBAL_TOP_10 |>
  filter(show_title == "Red Notice", year(week) == 2021) |>       
  summarize(
    `Total Hours Viewed` = sum(weekly_hours_viewed, na.rm = TRUE),
    `View Estimate` = round(`Total Hours Viewed` / runtime_hours, 0),
    .groups = "drop"
  )


DT::datatable(
  red_notice_views_2021,
  options = list(dom = 't', paging = FALSE, ordering = FALSE, info = FALSE),
  rownames = FALSE
) |>
  DT::formatRound(c("Total Hours Viewed", "View Estimate"), 0)
```

::: {.cell-output-display}

```{=html}
<div class="datatables html-widget html-fill-item" id="htmlwidget-b22574056f4684526b2e" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b22574056f4684526b2e">{"x":{"filter":"none","vertical":false,"data":[[396740000],[201732203]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Total Hours Viewed<\/th>\n      <th>View Estimate<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","paging":false,"ordering":false,"info":false,"columnDefs":[{"targets":0,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \",\", \".\", null);\n  }"},{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[0,1]},{"name":"Total Hours Viewed","targets":0},{"name":"View Estimate","targets":1}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render"],"jsHooks":[]}</script>
```

:::
:::






* 9.A total of **45 films** in the U.S. Netflix Top 10 did not debut at Number 1 but later rose to the top spot during their chart runs.
The most recent example is **Unknown Number: The High School Catfish**, which debuted at #4 and reached #1 in the week of September 7, 2025.

::: {.cell}

```{.r .cell-code}
us_film_risers <- COUNTRY_TOP_10 |>
  filter(country_name == "United States",
         str_detect(category, "^Film")) |>
  arrange(show_title, week) |>
  group_by(show_title) |>
  summarize(
    debut_week      = min(week),
    debut_rank      = weekly_rank[which.min(week)],
    ever_no1        = any(weekly_rank == 1),
    first_week_at_1 = if (any(weekly_rank == 1))
                        min(week[weekly_rank == 1]) else as.Date(NA)
  ) |>
  ungroup() |>
  filter(ever_no1, debut_rank != 1) |>
  arrange(desc(debut_week))

n_films <- us_film_risers |> nrow()

most_recent <- us_film_risers |>
  arrange(desc(first_week_at_1)) |>
  slice(1) |>
  select(show_title, first_week_at_1)


us_film_risers |>
  select(-ever_no1) |>
  rename(
    "Show Title"       = show_title,
    "Debut Week"       = debut_week,
    "Debut Rank"       = debut_rank,
    "First Week at #1" = first_week_at_1
  ) |>
  mutate(Total_Films = n_films) |>
  DT::datatable(
    caption = htmltools::tags$caption(
      style = 'caption-side: top; text-align: left; font-weight: bold;',
      sprintf("Total films that debuted below #1 but later reached #1: %d films", n_films)
    ),
    options = list(
      dom = 't',
      paging = FALSE,
      ordering = TRUE,
      info = FALSE
    ),
    rownames = FALSE
  )
```

::: {.cell-output-display}

```{=html}
<div class="datatables html-widget html-fill-item" id="htmlwidget-5c7dc409b69814d0c2d1" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5c7dc409b69814d0c2d1">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: top; text-align: left; font-weight: bold;\">Total films that debuted below #1 but later reached #1: 45 films<\/caption>","data":[["Unknown Number: The High School Catfish","KPop Demon Hunters","Plane","The Wild Robot","Despicable Me 4","Don't Move","The Garfield Movie","Uglies","Jack Reacher: Never Go Back","Irish Wish","Lover, Stalker, Killer","The Postcard Killings","The Hill","No Hard Feelings","American Made","Love Again","Hidden Strike","They Cloned Tyrone","Puss in Boots: The Last Wish","The Boss Baby","Missing","Whitney Houston: I Wanna Dance with Somebody","Dog Gone","Prisoners","Bullet Train","Slumberland","Where the Crawdads Sing","Enola Holmes 2","Luckiest Girl Alive","Last Seen Alive","Lou","Father Stu","End of the Road","Day Shift","Uncharted","Purple Hearts","The Sea Beast","Despicable Me 2","The Tinder Swindler","He's All That","Aftermath","The Vault","Blood Red Sky","Twilight","Mother's Day"],["2025-08-31","2025-06-22","2025-06-15","2025-05-25","2025-03-02","2024-10-27","2024-09-22","2024-09-15","2024-08-04","2024-03-17","2024-02-11","2024-01-28","2024-01-21","2023-10-22","2023-10-08","2023-09-03","2023-07-30","2023-07-23","2023-07-16","2023-05-28","2023-05-21","2023-04-23","2023-01-15","2022-12-11","2022-12-04","2022-11-20","2022-11-13","2022-11-06","2022-10-09","2022-10-02","2022-09-25","2022-09-18","2022-09-11","2022-08-14","2022-08-07","2022-07-31","2022-07-10","2022-02-06","2022-02-06","2021-08-29","2021-08-08","2021-08-01","2021-07-25","2021-07-18","2021-07-04"],[4,6,2,3,2,3,4,2,2,2,2,7,9,3,9,3,2,3,3,6,5,2,4,4,2,3,4,2,2,4,2,6,2,2,2,2,5,2,3,2,4,9,5,3,5],["2025-09-07","2025-08-10","2025-06-22","2025-06-01","2025-03-09","2024-11-03","2024-09-29","2024-09-22","2024-08-11","2024-03-24","2024-02-18","2024-02-04","2024-01-28","2023-10-29","2023-10-15","2023-09-10","2023-08-06","2023-07-30","2023-07-23","2023-06-04","2023-05-28","2023-04-30","2023-01-22","2022-12-18","2022-12-11","2022-11-27","2022-11-20","2022-11-13","2022-10-16","2022-10-09","2022-10-02","2022-09-25","2022-09-18","2022-08-21","2022-08-14","2022-08-07","2022-07-17","2025-01-12","2022-02-13","2021-09-05","2025-02-16","2021-08-08","2021-08-01","2021-07-25","2021-07-11"],[45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Show Title<\/th>\n      <th>Debut Week<\/th>\n      <th>Debut Rank<\/th>\n      <th>First Week at #1<\/th>\n      <th>Total_Films<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","paging":false,"ordering":true,"info":false,"columnDefs":[{"className":"dt-right","targets":[2,4]},{"name":"Show Title","targets":0},{"name":"Debut Week","targets":1},{"name":"Debut Rank","targets":2},{"name":"First Week at #1","targets":3},{"name":"Total_Films","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
```

:::
:::






* 10. **Emily in Paris: Season 2** reached the Top 10 charts in the most countries during its debut week — appearing in the Top 10 in 94 countries for the week of December 26, 2021.

::: {.cell}

```{.r .cell-code}
tv_debut_countries <- COUNTRY_TOP_10 |>
  filter(str_detect(category, "^TV")) |>
  group_by(show_title, season_title, country_name) |>
  summarize(debut_week = min(week), .groups = "drop") |>
  group_by(show_title, season_title, debut_week) |>
  summarize(n_countries = n_distinct(country_name), .groups = "drop") |>
  arrange(desc(n_countries)) |>
  rename(
    "Show Title" = show_title,
    "Season Title" = season_title,
    "Debut Week" = debut_week,
    "Number of Countries" = n_countries
  )

# Top TV show/season
top_tv_debut <- tv_debut_countries |>
  slice(1)

top_tv_debut |>
  DT::datatable(
    caption = htmltools::tags$caption(
      style = 'caption-side: top; text-align: left; font-weight: bold;',
      "TV show/season that charted in the most countries on its debut week"
    ),
    options = list(
      dom = 't',
      paging = FALSE,
      ordering = TRUE,
      info = FALSE
    ),
    rownames = FALSE
  )
```

::: {.cell-output-display}

```{=html}
<div class="datatables html-widget html-fill-item" id="htmlwidget-51ba10ff57c633fc2e56" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-51ba10ff57c633fc2e56">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: top; text-align: left; font-weight: bold;\">TV show/season that charted in the most countries on its debut week<\/caption>","data":[["Emily in Paris"],["Emily in Paris: Season 2"],["2021-12-26"],[94]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Show Title<\/th>\n      <th>Season Title<\/th>\n      <th>Debut Week<\/th>\n      <th>Number of Countries<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","paging":false,"ordering":true,"info":false,"columnDefs":[{"className":"dt-right","targets":3},{"name":"Show Title","targets":0},{"name":"Season Title","targets":1},{"name":"Debut Week","targets":2},{"name":"Number of Countries","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
```

:::
:::


# Press Release 1: Upcoming Season of Stranger Things

## The Final Countdown: Stranger Things Returns to Conquer the World Once More

With over 290 million viewing hours and a global legacy that outshines every English-language series, Netflix’s Stranger Things prepares for its grand finale.

As Netflix gears up for the release of Stranger Things Season 5 at the end of 2025, the series continues to stand as one of the platform’s most remarkable success stories. Across its first four seasons, Stranger Things amassed an incredible 296.8 million viewing hours, remaining in the Global Top 10 for a combined 50 weeks and captivating audiences in over 90 countries. Each new season expanded its global reach — with Season 4 alone spending 19 weeks in the Top 10 and reaching viewers across 93 nations. Compared with other major English-language hits like Wednesday and Bridgerton, Stranger Things remains Netflix’s #1 most-watched show of all time, proving its unmatched power to unite fans across generations and continents. With anticipation at an all-time high, the final season is expected to shatter streaming records once again and reinforce Netflix’s dominance in global entertainment.


::: {.cell}

```{.r .cell-code}
#Load Packages

if(!require("tidyverse")) install.packages("tidyverse")
library(readr)
library(dplyr)
library(stringr)
library(DT)

#Acquire Data

if(!dir.exists(file.path("data", "mp01"))){
    dir.create(file.path("data", "mp01"), showWarnings=FALSE, recursive=TRUE)
}

GLOBAL_TOP_10_FILENAME <- file.path("data", "mp01", "global_top10_alltime.csv")

if(!file.exists(GLOBAL_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-global.tsv", 
                  destfile=GLOBAL_TOP_10_FILENAME)
}

COUNTRY_TOP_10_FILENAME <- file.path("data", "mp01", "country_top10_alltime.csv")

if(!file.exists(COUNTRY_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-countries.tsv", 
                  destfile=COUNTRY_TOP_10_FILENAME)
}

#Read files

GLOBAL_TOP_10 <- read_tsv(
  GLOBAL_TOP_10_FILENAME, na = "N/A", show_col_types = FALSE)

COUNTRY_TOP_10 <- read_tsv(
  COUNTRY_TOP_10_FILENAME,na = "N/A", show_col_types = FALSE)


#Formatted


format_titles <- function(df){
    colnames(df) <- str_replace_all(colnames(df), "_", " ") |> str_to_title()
    df
}

#Season 1~4
# ---------- Helper: parse season number (N/A -> Season 1) ----------
parse_st_season <- function(season_title) {
  s <- str_extract(season_title %||% "", "\\d+")
  ifelse(is.na(s) | season_title %in% c("N/A", "NA", ""), 1L, as.integer(s))
}

# ---------- Filter Stranger Things (TV), build season_no & clean labels ----------
st_global_raw <- GLOBAL_TOP_10 |>
  filter(str_detect(category, "^TV"),
         show_title == "Stranger Things") |>
  mutate(season_no = parse_st_season(season_title),
         season_label = paste0("Stranger Things: Season ", season_no)) |>
  filter(season_no %in% 1:4)

st_country_raw <- COUNTRY_TOP_10 |>
  filter(str_detect(category, "^TV"),
         show_title == "Stranger Things") |>
  mutate(season_no = parse_st_season(season_title),
         season_label = paste0("Stranger Things: Season ", season_no)) |>
  filter(season_no %in% 1:4)

# ---------- 1) Total hours & weeks in global Top 10 (by season) ----------
st_global <- st_global_raw |>
  group_by(season_no, season_label) |>
  summarize(
    total_hours_viewed    = sum(weekly_hours_viewed, na.rm = TRUE),
    weeks_in_global_top10 = n_distinct(week),
    .groups = "drop"
  )

# ---------- 2) Countries where each season charted at least once ----------
st_countries <- st_country_raw |>
  group_by(season_no, season_label) |>
  summarize(
    countries_ever_charted = n_distinct(country_name),
    .groups = "drop"
  )

# ---------- 3) Multinational appeal of *previous* seasons ----------
#     = number of distinct countries that charted any earlier season
countries_by_season <- st_country_raw |>
  distinct(season_no, country_name) |>
  group_by(season_no) |>
  summarize(countries = list(unique(country_name)), .groups = "drop")

prior_counts <- tibble(season_no = 1:4) |>
  mutate(
    prior_countries = map_int(
      season_no,
      ~ {
        earlier <- countries_by_season |>
          filter(season_no < .x)
        length(unique(unlist(earlier$countries)))
      }
    )
  )

# ---------- 4) Combine & present ----------
st_summary <- st_global |>
  left_join(st_countries, by = c("season_no", "season_label")) |>
  left_join(prior_counts,  by = "season_no") |>
  arrange(season_no) |>
  rename(
    `Season No`               = season_no,
    `Season Title`            = season_label,
    `Total Hours Viewed`      = total_hours_viewed,
    `Weeks in Global Top 10`  = weeks_in_global_top10,
    `Countries Charted`       = countries_ever_charted,
    `Countries (Prior Seasons)` = prior_countries
  )

DT::datatable(
  st_summary |>
    select(-`Countries (Prior Seasons)`), 
  caption = htmltools::tags$caption(
    style = 'caption-side: top; text-align: left; font-weight: bold;',
    "Stranger Things S1–S4: Global Hours, Longevity, and Multinational Reach"
  ),
  options = list(
    dom = 't',
    paging = FALSE,
    ordering = TRUE,
    info = FALSE
  ),
  rownames = FALSE
)
```

::: {.cell-output-display}

```{=html}
<div class="datatables html-widget html-fill-item" id="htmlwidget-e7715d54516c56b627cf" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e7715d54516c56b627cf">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: top; text-align: left; font-weight: bold;\">Stranger Things S1–S4: Global Hours, Longevity, and Multinational Reach<\/caption>","data":[[1,2,3,4],["Stranger Things: Season 1","Stranger Things: Season 2","Stranger Things: Season 3","Stranger Things: Season 4"],[372450000,352700000,355520000,1887310000],[10,10,11,19],[93,91,90,93]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Season No<\/th>\n      <th>Season Title<\/th>\n      <th>Total Hours Viewed<\/th>\n      <th>Weeks in Global Top 10<\/th>\n      <th>Countries Charted<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","paging":false,"ordering":true,"info":false,"columnDefs":[{"className":"dt-right","targets":[0,2,3,4]},{"name":"Season No","targets":0},{"name":"Season Title","targets":1},{"name":"Total Hours Viewed","targets":2},{"name":"Weeks in Global Top 10","targets":3},{"name":"Countries Charted","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
```

:::

```{.r .cell-code}
#Comparison with other programs

# 1) English-language TV only (global table)
tv_en_global <- GLOBAL_TOP_10 |>
  filter(str_detect(category, "^TV \\(English\\)"))

# 2) Aggregate by show (across all seasons)
#    - total_hours_viewed: sum of viewing hours
#    - weeks_in_global_top10: distinct weeks the show (any season) appeared
tv_en_summary <- tv_en_global |>
  group_by(show_title) |>
  summarize(
    total_hours_viewed = sum(weekly_hours_viewed, na.rm = TRUE),
    weeks_in_global_top10 = n_distinct(week),
    .groups = "drop"
  )

# 3) Pick the comparison set:
#    - Stranger Things
#    - Top 3 other English-language TV shows by total_hours_viewed
st_row <- tv_en_summary |>
  filter(show_title == "Stranger Things")

top3_others <- tv_en_summary |>
  filter(show_title != "Stranger Things") |>
  slice_max(total_hours_viewed, n = 3)

compare_tbl <- bind_rows(st_row, top3_others) |>
  arrange(desc(total_hours_viewed)) |>
  mutate(
    rank_by_hours = row_number(),
    share_vs_total = total_hours_viewed / sum(total_hours_viewed)
  )

# 4) Pretty column names + table
compare_tbl |>
  rename(
    `Show Title` = show_title,
    `Total Hours Viewed` = total_hours_viewed,
    `Weeks in Global Top 10` = weeks_in_global_top10,
    `Rank (by Hours)` = rank_by_hours
  ) |>
  select(`Show Title`, `Rank (by Hours)`, `Total Hours Viewed`, `Weeks in Global Top 10`) |>  # ✅ 순서 조정 및 Share 열 제거
  DT::datatable(
    caption = htmltools::tags$caption(
      style = 'caption-side: top; text-align: left; font-weight: bold;',
      "Stranger Things vs. Top English-Language TV Shows (Global)"
    ),
    options = list(
      dom = 't',
      paging = FALSE,
      ordering = TRUE,
      info = FALSE
    ),
    rownames = FALSE
  )
```

::: {.cell-output-display}

```{=html}
<div class="datatables html-widget html-fill-item" id="htmlwidget-0832143279ef0e38481d" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0832143279ef0e38481d">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: top; text-align: left; font-weight: bold;\">Stranger Things vs. Top English-Language TV Shows (Global)<\/caption>","data":[["Stranger Things","Wednesday","Bridgerton","Ginny &amp; Georgia"],[1,2,3,4],[2967980000,2876350000,2279710000,1556880000],[20,29,26,13]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Show Title<\/th>\n      <th>Rank (by Hours)<\/th>\n      <th>Total Hours Viewed<\/th>\n      <th>Weeks in Global Top 10<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","paging":false,"ordering":true,"info":false,"columnDefs":[{"className":"dt-right","targets":[1,2,3]},{"name":"Show Title","targets":0},{"name":"Rank (by Hours)","targets":1},{"name":"Total Hours Viewed","targets":2},{"name":"Weeks in Global Top 10","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
```

:::
:::

# Press Release 2: Commercial Success in India

## Netflix India Surges Ahead with Hindi Hits: Local Stories Power 46% Growth in 2024

Netflix continues to strengthen its presence in India as Hindi-language content drives record engagement across the platform. In 2024, Hindi programs achieved over 40 million total viewing hours, marking a 46.2% year-over-year increase from 2023. Films such as RRR (Hindi), Kalki 2898 AD (Hindi), and Major (Hindi) led the charts, proving the strong appeal of regional storytelling. Additionally, several titles—including Boomika (Hindi) and Raw (Hindi)—ranked in India’s Top 10 while never appearing in the U.S. charts, underscoring the country’s growing base of domestic viewers. With India’s vast and passionate audience, Netflix’s investment in Hindi-language productions is clearly translating into sustained subscriber growth and cultural impact.


::: {.cell}

```{.r .cell-code}
#Load Packages

if(!require("tidyverse")) install.packages("tidyverse")
library(readr)
library(dplyr)
library(stringr)
library(DT)

#Acquire Data

if(!dir.exists(file.path("data", "mp01"))){
    dir.create(file.path("data", "mp01"), showWarnings=FALSE, recursive=TRUE)
}

GLOBAL_TOP_10_FILENAME <- file.path("data", "mp01", "global_top10_alltime.csv")

if(!file.exists(GLOBAL_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-global.tsv", 
                  destfile=GLOBAL_TOP_10_FILENAME)
}

COUNTRY_TOP_10_FILENAME <- file.path("data", "mp01", "country_top10_alltime.csv")

if(!file.exists(COUNTRY_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-countries.tsv", 
                  destfile=COUNTRY_TOP_10_FILENAME)
}

#Read files

GLOBAL_TOP_10 <- read_tsv(
  GLOBAL_TOP_10_FILENAME, na = "N/A", show_col_types = FALSE)

COUNTRY_TOP_10 <- read_tsv(
  COUNTRY_TOP_10_FILENAME,na = "N/A", show_col_types = FALSE)


#Formatted


format_titles <- function(df){
    colnames(df) <- str_replace_all(colnames(df), "_", " ") |> str_to_title()
    df
}
# ================================
# Load Packages
# ================================
if(!require("tidyverse")) install.packages("tidyverse")
library(readr)
library(dplyr)
library(stringr)
library(DT)
if(!require("lubridate")) install.packages("lubridate")
library(lubridate)

# ================================
# Acquire Data
# ================================
if(!dir.exists(file.path("data", "mp01"))){
  dir.create(file.path("data", "mp01"), showWarnings = FALSE, recursive = TRUE)
}

GLOBAL_TOP_10_FILENAME  <- file.path("data", "mp01", "global_top10_alltime.csv")
COUNTRY_TOP_10_FILENAME <- file.path("data", "mp01", "country_top10_alltime.csv")

if(!file.exists(GLOBAL_TOP_10_FILENAME)){
  download.file("https://www.netflix.com/tudum/top10/data/all-weeks-global.tsv",
                destfile = GLOBAL_TOP_10_FILENAME)
}
if(!file.exists(COUNTRY_TOP_10_FILENAME)){
  download.file("https://www.netflix.com/tudum/top10/data/all-weeks-countries.tsv",
                destfile = COUNTRY_TOP_10_FILENAME)
}

# ================================
# Read Files
# ================================
GLOBAL_TOP_10  <- read_tsv(GLOBAL_TOP_10_FILENAME,  na = "N/A", show_col_types = FALSE)
COUNTRY_TOP_10 <- read_tsv(COUNTRY_TOP_10_FILENAME, na = "N/A", show_col_types = FALSE)

# ================================
# Helper Functions
# ================================
format_titles <- function(df){
  colnames(df) <- str_replace_all(colnames(df), "_", " ") |> str_to_title()
  df
}
to_date_safe <- function(x){
  if (inherits(x, "Date")) x else as.Date(x)
}
s <- function(x) ifelse(is.na(x), "", x)

COUNTRY_TOP_10 <- COUNTRY_TOP_10 |> mutate(week = to_date_safe(week))
GLOBAL_TOP_10  <- GLOBAL_TOP_10  |> mutate(week = to_date_safe(week))

# ================================
# 1) Hindi programs that charted in India but NOT in the US
# ================================
india_hindi <- COUNTRY_TOP_10 |>
  filter(country_name == "India") |>
  filter(str_detect(s(show_title), "\\(Hindi\\)") | str_detect(s(season_title), "\\(Hindi\\)")) |>
  mutate(program_key = paste0(s(show_title), " || ", s(season_title)))

us_any <- COUNTRY_TOP_10 |>
  filter(country_name == "United States") |>
  mutate(program_key = paste0(s(show_title), " || ", s(season_title))) |>
  distinct(program_key)

india_hindi_not_us <- india_hindi |>
  anti_join(us_any, by = "program_key")

india_only_summary <- india_hindi_not_us |>
  group_by(show_title, season_title) |>
  summarize(
    debut_week  = min(week, na.rm = TRUE),
    best_rank   = suppressWarnings(min(weekly_rank, na.rm = TRUE)),
    total_weeks = n_distinct(week),
    .groups = "drop"
  ) |>
  select(show_title, debut_week, total_weeks) |>
  arrange(debut_week) |>
  format_titles()

DT::datatable(
  india_only_summary,
  caption = htmltools::tags$caption(
    style = 'caption-side: top; text-align: left; font-weight: bold;',
    "Hindi programs that charted in India but not in the US"
  ),
  options = list(dom = 't', paging = TRUE, pageLength = 10, ordering = TRUE, info = TRUE),
  rownames = FALSE
)
```

::: {.cell-output-display}

```{=html}
<div class="datatables html-widget html-fill-item" id="htmlwidget-3cfc3b9c8b748c68e7bc" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3cfc3b9c8b748c68e7bc">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: top; text-align: left; font-weight: bold;\">Hindi programs that charted in India but not in the US<\/caption>","data":[["Boomika (Hindi)","Annaatthe (Hindi)","Kurup (Hindi)","Hey Sinamika (Hindi)","Etharkkum Thunindhavan (Hindi)","Radhe Shyam (Hindi)","Raw (Hindi)","Major (Hindi)","Foot Fairy (Hindi)","Shabaash Mithu (Hindi)","The Ghost (Hindi)","GodFather (Hindi)","Kantara (Hindi)","DSP (Hindi)","Thunivu (Hindi)","Sir (Hindi)","Dasara (Hindi)","Bro (Hindi)","Bhola Shankar (Hindi)","Kushi (Hindi)","Chandramukhi 2 (Hindi)","Iraivan (Hindi)","Leo (Hindi)","Japan (Hindi)","Hi Papa (Hindi)","Guntur Kaaram (Hindi)","Merry Christmas (Hindi)","Aadujeevitham: The Goat Life (Hindi)","Kalki 2898 AD (Hindi)"],["2021-08-29","2021-11-28","2021-12-19","2022-04-03","2022-04-10","2022-05-08","2022-05-15","2022-07-03","2022-07-31","2022-08-14","2022-11-06","2022-11-20","2022-12-11","2023-01-08","2023-02-12","2023-03-19","2023-05-28","2023-08-27","2023-09-17","2023-10-08","2023-10-29","2023-10-29","2023-11-26","2023-12-17","2024-01-07","2024-02-11","2024-03-10","2024-07-28","2024-08-25"],[1,3,4,2,3,4,6,4,1,4,4,5,11,2,5,7,3,3,3,3,2,2,6,1,7,5,4,2,4]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Show Title<\/th>\n      <th>Debut Week<\/th>\n      <th>Total Weeks<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","paging":true,"pageLength":10,"ordering":true,"info":true,"columnDefs":[{"className":"dt-right","targets":2},{"name":"Show Title","targets":0},{"name":"Debut Week","targets":1},{"name":"Total Weeks","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
```

:::

```{.r .cell-code}
# =================================
# 2) Hindi-language global data (proxy for India)
#     Exclude: 2022, N Program Weeks, YoY Views Pct
#     Format: YoY Hours Pct as percentage (%)
# =================================
global_hindi <- GLOBAL_TOP_10 |>
  filter(str_detect(s(show_title), "\\(Hindi\\)") | str_detect(s(season_title), "\\(Hindi\\)")) |>
  mutate(year = year(week))

hindi_yearly <- global_hindi |>
  group_by(year) |>
  summarize(
    total_views = sum(suppressWarnings(as.numeric(weekly_views)), na.rm = TRUE),
    total_hours = sum(suppressWarnings(as.numeric(weekly_hours_viewed)), na.rm = TRUE),
    n_program_weeks = n(),
    .groups = "drop"
  ) |>
  arrange(year) |>
  mutate(
    yoy_views_pct = (total_views / lag(total_views) - 1) * 100,
    yoy_hours_pct = (total_hours / lag(total_hours) - 1) * 100
  ) |>
  filter(year != 2022) |>  # Exclude 2022
  mutate(
    yoy_hours_pct = paste0(round(yoy_hours_pct, 1), "%")  # Format as percentage string
  ) |>
  select(year, total_views, total_hours, yoy_hours_pct) |>  # Keep only relevant columns
  format_titles()

DT::datatable(
  hindi_yearly,
  caption = htmltools::tags$caption(
    style = 'caption-side: top; text-align: left; font-weight: bold;',
    "Hindi global viewership yearly totals (used as proxy for India)"
  ),
  options = list(dom = 't', paging = FALSE, ordering = TRUE, info = FALSE),
  rownames = FALSE
)
```

::: {.cell-output-display}

```{=html}
<div class="datatables html-widget html-fill-item" id="htmlwidget-c4aa2c3bcdbed0f92340" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c4aa2c3bcdbed0f92340">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: top; text-align: left; font-weight: bold;\">Hindi global viewership yearly totals (used as proxy for India)<\/caption>","data":[[2023,2024],[4300000,14800000],[27490000,40200000],["-76.2%","46.2%"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Year<\/th>\n      <th>Total Views<\/th>\n      <th>Total Hours<\/th>\n      <th>Yoy Hours Pct<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","paging":false,"ordering":true,"info":false,"columnDefs":[{"className":"dt-right","targets":[0,1,2]},{"name":"Year","targets":0},{"name":"Total Views","targets":1},{"name":"Total Hours","targets":2},{"name":"Yoy Hours Pct","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
```

:::

```{.r .cell-code}
# ================================
# 3) Highlight: Top Hindi programs globally (proxy for India)
# ================================
hindi_title_totals <- global_hindi |>
  group_by(show_title, season_title) |>
  summarize(
    total_views = sum(suppressWarnings(as.numeric(weekly_views)), na.rm = TRUE),
    total_hours = sum(suppressWarnings(as.numeric(weekly_hours_viewed)), na.rm = TRUE),
    total_weeks = n_distinct(week),
    best_global_rank = suppressWarnings(min(weekly_rank, na.rm = TRUE)),
    .groups = "drop"
  ) |>
  arrange(desc(total_hours), desc(total_views))

hindi_title_top <- hindi_title_totals |>
  mutate(program_key = paste0(s(show_title), ifelse(s(season_title) == "", "", paste0(" — ", s(season_title))))) |>
  select(program_key, total_hours, best_global_rank) |>  # Keep only these columns
  format_titles()

DT::datatable(
  hindi_title_top,
  caption = htmltools::tags$caption(
    style = 'caption-side: top; text-align: left; font-weight: bold;',
    "Top Hindi programs globally by total hours (proxy for India audience)"
  ),
  options = list(dom = 't', paging = TRUE, pageLength = 10, ordering = TRUE, info = TRUE),
  rownames = FALSE
)
```

::: {.cell-output-display}

```{=html}
<div class="datatables html-widget html-fill-item" id="htmlwidget-a28449c3c23d869c82c1" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a28449c3c23d869c82c1">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: top; text-align: left; font-weight: bold;\">Top Hindi programs globally by total hours (proxy for India audience)<\/caption>","data":[["RRR (Hindi)","Kalki 2898 AD (Hindi)","Major (Hindi)","Guntur Kaaram (Hindi)","Kantara (Hindi)","Raw (Hindi)","Shabaash Mithu (Hindi)","Leo (Hindi)","Thunivu (Hindi)","Merry Christmas (Hindi)","Radhe Shyam (Hindi)","GodFather (Hindi)","Sir (Hindi)","Hi Papa (Hindi)","Bhola Shankar (Hindi)","Foot Fairy (Hindi)","Bro (Hindi)"],[79780000,23100000,8160000,7600000,7490000,7370000,7110000,6800000,6680000,6400000,5550000,4340000,3120000,3100000,2300000,2200000,1900000],[1,1,2,8,9,5,7,3,4,6,7,5,8,4,8,9,8]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Program Key<\/th>\n      <th>Total Hours<\/th>\n      <th>Best Global Rank<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","paging":true,"pageLength":10,"ordering":true,"info":true,"columnDefs":[{"className":"dt-right","targets":[1,2]},{"name":"Program Key","targets":0},{"name":"Total Hours","targets":1},{"name":"Best Global Rank","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
```

:::

```{.r .cell-code}
# =================================
# 4) Key metrics for press release (latest year)
# =================================
hindi_yearly_raw <- GLOBAL_TOP_10 |>
  filter(str_detect(s(show_title), "\\(Hindi\\)") | str_detect(s(season_title), "\\(Hindi\\)")) |>
  mutate(year = year(week)) |>
  group_by(year) |>
  summarize(
    total_views = sum(suppressWarnings(as.numeric(weekly_views)), na.rm = TRUE),
    total_hours = sum(suppressWarnings(as.numeric(weekly_hours_viewed)), na.rm = TRUE),
    .groups = "drop"
  ) |>
  arrange(year) |>
  mutate(
    yoy_views_pct = (total_views / lag(total_views) - 1) * 100,
    yoy_hours_pct = (total_hours / lag(total_hours) - 1) * 100
  )

if(nrow(hindi_yearly_raw) > 0){
  latest_year <- max(hindi_yearly_raw$year, na.rm = TRUE)
  latest_row  <- hindi_yearly_raw |> dplyr::filter(year == latest_year)
  prev_row    <- hindi_yearly_raw |> dplyr::filter(year == latest_year - 1)

  #cat("\n---- Numbers for Press Release ----\n")
  #cat("Latest Year:", latest_year, "\n")
  #cat("Total Hindi Views (global, proxy India):", format(latest_row$total_views, big.mark=","), "\n")
  #cat("Total Hindi Hours (global, proxy India):", format(latest_row$total_hours, big.mark=","), "\n")
  #if(nrow(prev_row) == 1){
  #  cat("YoY Hours Growth (%):", round(latest_row$yoy_hours_pct, 1), "%\n")
  #} else {
  #  cat("YoY not available (no prior year)\n")
  #}
  #cat("-----------------------------------\n\n")
}
```
:::




# Press Release 3: Open Topic

## Netflix Celebrates Global Success of Non-English Films as International Viewership Surges 10% in 2024

Netflix continues to strengthen its global presence as Non-English films saw a remarkable 10.2% year-over-year growth in total viewing hours from 2023 to 2024 — the highest among all categories. Leading this surge were international blockbusters such as Society of the Snow, which amassed 235.9 million total viewing hours, followed by Under Paris with 190.1 million hours, and All Quiet on the Western Front, which held the Top 10 chart for an impressive 23 weeks. While English-language films showed a modest 0.8% growth, global audiences are increasingly drawn to diverse, high-quality storytelling beyond language barriers. This success underscores Netflix’s expanding appeal among international audiences and its commitment to investing in global content.




::: {.cell}

```{.r .cell-code}
#Load Packages

if(!require("tidyverse")) install.packages("tidyverse")
library(readr)
library(dplyr)
library(stringr)
library(DT)
library(lubridate)

#Acquire Data

if(!dir.exists(file.path("data", "mp01"))){
    dir.create(file.path("data", "mp01"), showWarnings=FALSE, recursive=TRUE)
}

GLOBAL_TOP_10_FILENAME <- file.path("data", "mp01", "global_top10_alltime.csv")

if(!file.exists(GLOBAL_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-global.tsv", 
                  destfile=GLOBAL_TOP_10_FILENAME)
}

COUNTRY_TOP_10_FILENAME <- file.path("data", "mp01", "country_top10_alltime.csv")

if(!file.exists(COUNTRY_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-countries.tsv", 
                  destfile=COUNTRY_TOP_10_FILENAME)
}

#Read files

GLOBAL_TOP_10 <- read_tsv(
  GLOBAL_TOP_10_FILENAME, na = "N/A", show_col_types = FALSE)

COUNTRY_TOP_10 <- read_tsv(
  COUNTRY_TOP_10_FILENAME,na = "N/A", show_col_types = FALSE)




#“Year-over-Year Growth by Category (2023 → 2024)

GLOBAL_TOP_10 <- GLOBAL_TOP_10 |>
  mutate(week = as.Date(week))

cat_year_hours <- GLOBAL_TOP_10 |>
  mutate(year = year(week)) |>
  filter(year %in% c(2022, 2023, 2024)) |>
  group_by(category, year) |>
  summarize(
    total_hours_viewed = sum(weekly_hours_viewed, na.rm = TRUE),
    .groups = "drop"
  )

cat_2023 <- cat_year_hours |>
  filter(year == 2023) |>
  select(category, total_2023 = total_hours_viewed)

cat_2024 <- cat_year_hours |>
  filter(year == 2024) |>
  select(category, total_2024 = total_hours_viewed)

cat_yoy_wide <- full_join(cat_2023, cat_2024, by = "category") |>
  mutate(
    `YoY (%)` = round((total_2024 / total_2023 - 1) * 100, 1)
  ) |>
  rename(
    `Total Hours Viewed (2023)` = total_2023,
    `Total Hours Viewed (2024)` = total_2024
  ) |>
  select(category, `Total Hours Viewed (2023)`, `Total Hours Viewed (2024)`, `YoY (%)`) |>
  arrange(desc(`YoY (%)`))  

DT::datatable(
  cat_yoy_wide,
  caption = htmltools::tags$caption(
    style = 'caption-side: top; text-align: left; font-weight: bold;',
    "Year-over-Year Growth by Category (2023 → 2024)"
  ),
  options = list(dom = 't', paging = FALSE, ordering = TRUE, info = FALSE),
  rownames = FALSE
) |>
  DT::formatRound(c("Total Hours Viewed (2023)", "Total Hours Viewed (2024)"), 0) |>
  DT::formatRound("YoY (%)", 1)
```

::: {.cell-output-display}

```{=html}
<div class="datatables html-widget html-fill-item" id="htmlwidget-7d7c230e959ae9be21e7" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7d7c230e959ae9be21e7">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: top; text-align: left; font-weight: bold;\">Year-over-Year Growth by Category (2023 → 2024)<\/caption>","data":[["Films (Non-English)","Films (English)","TV (English)","TV (Non-English)"],[3411810000,7126400000,14556770000,10283140000],[3761500000,7181300000,13462100000,8963900000],[10.2,0.8,-7.5,-12.8]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>category<\/th>\n      <th>Total Hours Viewed (2023)<\/th>\n      <th>Total Hours Viewed (2024)<\/th>\n      <th>YoY (%)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","paging":false,"ordering":true,"info":false,"columnDefs":[{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \",\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,2,3]},{"name":"category","targets":0},{"name":"Total Hours Viewed (2023)","targets":1},{"name":"Total Hours Viewed (2024)","targets":2},{"name":"YoY (%)","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render"],"jsHooks":[]}</script>
```

:::

```{.r .cell-code}
#Top 3 Non-English Films

top_noneng_films <- GLOBAL_TOP_10 |>
  filter(category == "Films (Non-English)") |>              
  group_by(show_title) |>
  summarize(
    total_hours_viewed = sum(weekly_hours_viewed, na.rm = TRUE),
    cumulative_weeks_in_top_10 = max(cumulative_weeks_in_top_10, na.rm = TRUE),
    .groups = "drop"
  ) |>
  arrange(desc(total_hours_viewed), desc(cumulative_weeks_in_top_10)) |>
  slice_head(n = 3) |>
  rename(
    `Show Title` = show_title,
    `Total Hours Viewed` = total_hours_viewed,
    `Cumulative Weeks in Top 10` = cumulative_weeks_in_top_10
  )


DT::datatable(
  top_noneng_films,
  caption = htmltools::tags$caption(
    style = 'caption-side: top; text-align: left; font-weight: bold;',
    "Top 3 Non-English Films by Total Hours Viewed and Longevity in Top 10 (2024)"
  ),
  options = list(
    dom = 't',
    paging = FALSE,
    ordering = TRUE,
    info = FALSE
  ),
  rownames = FALSE
) |>
  DT::formatRound("Total Hours Viewed", 0)
```

::: {.cell-output-display}

```{=html}
<div class="datatables html-widget html-fill-item" id="htmlwidget-c449381466f83a3a17d4" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c449381466f83a3a17d4">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: top; text-align: left; font-weight: bold;\">Top 3 Non-English Films by Total Hours Viewed and Longevity in Top 10 (2024)<\/caption>","data":[["Society of the Snow","Under Paris","All Quiet on the Western Front"],[235900000,190100000,176490000],[12,21,23]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Show Title<\/th>\n      <th>Total Hours Viewed<\/th>\n      <th>Cumulative Weeks in Top 10<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","paging":false,"ordering":true,"info":false,"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,2]},{"name":"Show Title","targets":0},{"name":"Total Hours Viewed","targets":1},{"name":"Cumulative Weeks in Top 10","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render"],"jsHooks":[]}</script>
```

:::
:::


